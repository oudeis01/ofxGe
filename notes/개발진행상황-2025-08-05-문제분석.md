# GLSL 플러그인 시스템 문제 분석 보고서
**날짜: 2025년 8월 5일**  
**문제: st.x 인자 사용 시 검은 화면 렌더링 문제**

## 📋 문제 상황

### **증상**
- `["st", "time", "1.0"]` → 정상 노이즈 패턴 출력
- `["st.x", "time", "1.0"]` → 검정 화면만 출력 (컴파일 에러 없음)

### **분석된 차이점**
- `st` 버전: `vec4` 오버로드, `snoise(vec2 st, float time, float literal_0)`
- `st.x` 버전: `vec3` 오버로드, `snoise(float st_x, float time, float literal_0)`

### **추정 원인**
1. **노이즈 차원성**: `st.x` (1차원) vs `st` (2차원) 노이즈의 시각적 차이
2. **값 범위**: 1차원 노이즈가 시각적으로 구분되지 않는 범위일 가능성
3. **색상 매핑**: 노이즈 값의 색상 변환 과정에서 문제

## 🔍 로그 분석 결과

### **error.log vs ok.log 핵심 차이점**

#### **1. 성분 수 계산 차이**
- **error.log**: `User arguments need 3 components total` → vec3 오버로드
- **ok.log**: `User arguments need 4 components total` → vec4 오버로드

#### **2. 래핑 함수 차이**
**error.log (문제 케이스)**:
```glsl
float snoise(float st_x, float time, float literal_0) {
    return snoise(vec3(st_x, time, literal_0));
}
```

**ok.log (정상 케이스)**:
```glsl
float snoise(vec2 st, float time, float literal_0) {
    return snoise(vec4(st, time, literal_0));
}
```

#### **3. 메인 함수 호출 차이**
**error.log**: `snoise(st.x, time, 1.0)` → 1차원 노이즈
**ok.log**: `snoise(st, time, 1.0)` → 2차원 기반 노이즈

## 🎯 **문제 원인 진단**

### **핵심 문제: vec3 생성자의 잘못된 사용**

문제의 래핑 함수에서:
```glsl
return snoise(vec3(st_x, time, literal_0));
```

이것은 `vec3(float, float, float)` 생성자를 사용하여 **3차원 노이즈**를 호출합니다.
- `st_x`: 0.0~1.0 범위의 X 좌표
- `time`: 계속 증가하는 시간값  
- `literal_0`: 고정값 1.0

### **문제점 분석**

1. **노이즈 특성 차이**:
   - 2D 노이즈 `snoise(vec2)`: 공간적 패턴 생성
   - 3D 노이즈 `snoise(vec3)`: 시간축 포함한 입체적 패턴

2. **좌표계 문제**:
   - `vec3(st.x, time, 1.0)`에서 Y축 정보 완전 손실
   - 모든 픽셀이 동일한 X라인에서만 노이즈 샘플링
   - 시간축 변화로 인한 노이즈값 변동이 시각적으로 미미

3. **값 범위 문제**:
   - 3D 노이즈 결과값이 시각적 임계값 아래에 있을 가능성

## 🔧 **해결 방안**

### **방안 1: 2D 노이즈로 강제 변환**
사용자가 `st.x`를 사용해도 2D 패턴을 생성하도록 수정:
```glsl
return snoise(vec2(st_x, st_x * 0.7 + time * 0.1));
```

### **방안 2: 1D 노이즈 시각화 개선**
1D 노이즈 결과를 더 명확하게 표시:
```glsl
float result = snoise(vec3(st_x, time, literal_0));
result = result * 0.5 + 0.5; // -1~1을 0~1로 정규화
outputColor = vec4(vec3(result), 1.0);
```

### **방안 3: 타입 시스템 수정**
`st.x` 사용 시 자동으로 적절한 2D 패턴으로 확장하는 로직 추가

## 📊 **권장 해결책**

**즉시 적용 가능한 방안**: ShaderManager의 래핑 함수 생성 로직에서 1D 케이스를 2D로 확장하는 특별 처리 추가.
